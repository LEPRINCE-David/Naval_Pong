<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8>
    <title>NavalPong</title>
    <style>
            body { margin: 0;  overflow-x: hidden; }
            canvas { width: 100%; height: 100%; display: block; }
            .line1 {
                fill: green;
                stroke: black;
                stroke-width: 1.5px;
                opacity:0.5;
            } 
            .imageIntro {
                width: 101%;
                height: auto;
                position: absolute;
            }
            .titreIntro {
                position: absolute;
                margin-left: 20%;
                text-decoration: line-through;
                font-size: 25px;
                font-family: "Courier New", Courier, monospace;
            }
            .titreIntro2 {
                position: absolute;
                margin-left: 55%;
                font-size: 25px;
                font-family: "Courier New", Courier, monospace;
            }
            .titreIntro3 {
                position: absolute;
                margin-left: 45%;
                margin-top: 6%;
                text-decoration: underline;
                text-shadow: 1px 1px black;
                font-size: 31px;
                font-weight: bold;
                font-family: "Comic Sans MS", cursive, sans-serif;
            }
            .textIntro {
                position: absolute;
                margin-left: 5%;
                margin-top: 30%;
                font-size: 14px;
                font-family: "Courier New", Courier, monospace;
            }
            .boutonNavalPong {
                display: inline-block;
                position: absolute;
                padding: 15px 25px;
                font-size: 24px;
                cursor: pointer;
                text-align: center;
                text-decoration: none;
                outline: none;
                color: #fff;
                background-color: #0044FE;
                border: none;
                border-radius: 15px;
                box-shadow: 0 9px #999;
                margin-left: 15%;
                margin-top: 60%;
            }
            .boutonNavalPong:hover {background-color: #0535B9}
            .boutonNavalPong:active {
                background-color: #5DB4F7;
                box-shadow: 0 5px #666;
                transform: translateY(4px);
            }
            .boutonNavalPong:disabled {
                background: #ffffff;
            }
            .boutonClassicPong {
                display: inline-block;
                position: absolute;
                padding: 15px 25px;
                font-size: 24px;
                cursor: pointer;
                text-align: center;
                text-decoration: none;
                outline: none;
                color: #fff;
                background-color: #272727;
                border: none;
                border-radius: 15px;
                box-shadow: 0 9px #999;
                margin-left: 55%;
                margin-top: 60%;
            }
            .boutonClassicPong:hover {background-color: #000000}
            .boutonClassicPong:active {
                background-color: #111111;
                box-shadow: 0 5px #666;
                transform: translateY(4px);
            }
            .boutonClassicPong:disabled {
                background: #ffffff;
            }
            .defaite {
                display: inline-block;
                position: absolute;
                margin-left: 41%;
                margin-top: 1%;
                text-shadow: 1px 1px red;
                font-size: 31px;
                font-weight: bold;
                font-family: "Comic Sans MS", cursive, sans-serif;
            }
            .lancement {
                display: inline-block;
                position: absolute;
                margin-left: 43%;
                margin-top: 1%;
                text-shadow: 1px 1px white;
                font-size: 31px;
                font-weight: bold;
                font-family: "Comic Sans MS", cursive, sans-serif;
            }
            .mute {
                display: inline-block;
                position: absolute;
                padding: 15px 25px;
                font-size: 12px;
                cursor: pointer;
                text-align: center;
                text-decoration: none;
                outline: none;
                color: #fff;
                background-color: #272727;
                border: none;
                border-radius: 15px;
                margin-left: 0%;
            }
        </style>
  </head>
  <body>

    <div id=intro>
            <img class="imageIntro" src="src/medias/images/intro.png" alt="ImageIntro">
            <p class="titreIntro">
            Objet : Déclaration de Guerre
            </p>
            <p class="titreIntro2">
            Accords de la Mer Blanche
            </p>
            <p class="titreIntro3">
            NavalPong
            </p>
            <p class="textIntro">
            Soldat,<br/><br/>
            On nous tataa attaqués !<br/><br/>
            La déclaration de guerre à l'encontre de notre patrie s'est soldé par de fortes pertes de la part des 2 fronts.<br/>
            Le monde va mal et la guerre n'est pas prête de se terminer.<br/><br/>
            Mais il reste un espoir !<br/><br/>
            Avec les accords de la Mer Blanche, nous avons convenu avec l'ennemi une possible sortie de guerre.<br/><br/>
            Tout peut se jouer ici si vous voulez bien mener à la victoire notre partie de NavalPong !<br/><br/>
            Les règles du jeu sont simples : Envoyer la balle derrière leur ligne, toucher leur sous-marin, tout en protégeant nos lignes.<br/>
            Nous avons positionné des navires de guerre afin de vous aider à protéger du mieux que possible notre front.<br/>
            Mais ne vous fiez pas trop à eux !<br/><br/>
            Placez vous et en avant !<br/><br/>
            Nous comptons sur vous !<br/><br/>
            </p>

            <button id="lancerNavalPong" class="boutonNavalPong" disabled>Accepter et rejoindre le NavalPong</button>

            <button id="lancerClassicPong" class="boutonClassicPong" onclick="self.location.href='src/html/classic.html'" disabled>Refuser et retourner jouer au vrai Pong</button>

            <script>document.getElementById("lancerNavalPong").onclick = function () {
            document.getElementById('intro').innerHTML = '';
            document.getElementById('all').setAttribute("overflow-y", "hidden");
            document.getElementById('messageLancement').innerHTML = 'Appuyez sur L';
            var sound = new Howl({
              urls: ['src/medias/sounds/canon.mp3'],
              volume: 0.5
            }).play();};
            </script>
        </div>
    
    <button id="mute" class="mute">Mute</button>
        <script>document.getElementById("mute").onclick = function () {if (mute == false) {mute=true;Howler.mute();document.getElementById('mute').innerHTML = 'UnMute';}else {mute=false;Howler.unmute();document.getElementById('mute').innerHTML = 'Mute';}};
        </script>

        <div id="all">
        <div id="defaite" class="defaite">
        </div>
            <p id=messageLancement class="lancement">
            </p>

        <script src="src/js/three.js"></script>
        <script src="src/js/dat.gui.min.js"></script>
        <script src="src/js/stats.js"></script>
        <script src='src/js/THREEx.FullScreen.js'></script>
        <script src="src/js/water-material.js"></script>
        <script src="src/js/mirror.js"></script>
        <script src="src/js/window.js"></script>
        <script src="src/js/OrbitControls.js"></script>
        <script src="src/js/howler.js"></script>
        <script src="src/passes/EffectComposer.js"></script>
        <script src="src/passes/CopyShader.js"></script>
        <script src="src/passes/RenderPass.js"></script>
        <script src="src/passes/ShaderPass.js"></script>
        <script src="src/passes/HorizontalTiltShiftShader.js"></script>

          <script>
// Variables
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 20000);
            var composer;
            var postProcess = false;
            //var controls = new THREE.OrbitControls(camera);
            var helico = new THREE.Object3D();
            var helicoE = new THREE.Object3D();
            var loader = new THREE.JSONLoader();
            var contour = new THREE.Object3D();
            var contour_v = new THREE.Object3D();
            var contour_h = new THREE.Object3D();
            music();
            var mute = false;
            var sound = new Howl({
              urls: ['src/medias/sounds/intro.mp3'],
              volume: 0.2,
              buffer: true
            }).play();
            var Ball, Balle;
            var Bateau2, Bateau4;
            var baseE, baseP;
            var outlineMesh1, outlineMesh2, outlineMesh3, outlineMesh4, outlineMesh5;
            var sea;
            var Seagull, Shark, Whale;
            var bouee;
            var Line;
            var quadri;
            var bouees1, bouees2, bouees3, bouees4;
            var BoardP;
            var BoardE;
            var drapeauSprite;
            var contour_v, contour_h;
            var particleSystemP, particleSystemE;
            var circleP, circleE, circlePJoker, arrow1, arrow2, arrowL, arrowR, aiguille;
            var aiguilleX, aiguilleY;
            var BallposX, BallposY;
            var BallMovX = 0;
            var BallMovY = 0;
            var houleZ = 0;
            var houleX = 0;
            var run = 0;
            var MouseX, MouseY;
            var launch = 0;
            var sprite;
            var camHelico = false;
            var camMouette = false;
            var coeffVitBall = 1;
            var pleinEcran = false;
            var explosion = false;
// gestion qualite
            var lowquality = "true";
            var changequality = false;
            var bouees = "false";
            var changeBouees = false;
            var options = new THREE.Object3D();
            var barresBut = new THREE.Object3D();
            var boueesAlt = new THREE.Object3D();
            var vueAerienne = false;
            var spriteMap = new THREE.TextureLoader().load("src/medias/images/pirateLogo.png");
            spriteMap.wrapS = THREE.RepeatWrapping;
            spriteMap.repeat.x = - 1;
            var spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var pirateSprite = new THREE.Sprite( spriteMaterial );
            spriteMap = new THREE.TextureLoader().load("src/medias/images/helicopterSPrite.png");
            spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var ennemiSprite = new THREE.Sprite( spriteMaterial );
            ennemiSprite.scale.set(1.5, 1.5, 1.5);
            ennemiSprite.position.z = 2;
            spriteMap = new THREE.TextureLoader().load("src/medias/images/unSprite.png");
            spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var unSprite = new THREE.Sprite( spriteMaterial );
            spriteMap = new THREE.TextureLoader().load("src/medias/images/unSprite.png");
            spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var unSpriteE = new THREE.Sprite( spriteMaterial );
            spriteMap = new THREE.TextureLoader().load("src/medias/images/deuxSprite.png");
            spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var deuxSprite = new THREE.Sprite( spriteMaterial );
            spriteMap = new THREE.TextureLoader().load("src/medias/images/deuxSprite.png");
            spriteMaterial = new THREE.SpriteMaterial( { map: spriteMap, color: 0xffffff } );
            var deuxSpriteE = new THREE.Sprite( spriteMaterial );
            
// gestion bonus
            var bonus1 = new THREE.Object3D();
            var bonus2 = new THREE.Object3D();
            var bonus3 = new THREE.Object3D();
            var arbreBonusTerrain = false;
            var arbreBonus = false;
            var ssMarinBonusTerrain = true;
            var ssMarinBonus = false;
            var submarine;
            var submarineJoker;
            var invincible = false;
            var bateauxE = new THREE.Object3D();
            var contourE = new THREE.Object3D();
            var contour_vE = new THREE.Object3D();
            var contour_hE = new THREE.Object3D();
// gestion manches
            var scoreJoueur = 0;
            var scoreEnnemi = 0;
            var changementManche = false;
            var niveau = 1;
            var changementNiveau = false;
            var paperBoatScore  = new THREE.Object3D();
            var paperBoatScoreLow  = new THREE.Object3D();
            var gagnant = "";
// pv bateaux
            var pvBoat2 = 2;
            var pvBoat2E = 2;
            var pvBoat4 = 4;
            var pvBoat4E = 4;
// Deplacement joueur
            var PlayerDeplac = "nul";
            var haut = "nul";
            var hautI = 0;
            var bas = "nul";
            var basI = 0;
            var gauche = "nul";
            var gaucheI = 0;
            var droite = "nul";
            var droiteI = 0;
            var inertie = true;
// Gestion ennemi
            var EnemyDeplac = "nul";
            var hautE = "nul";
            var hautIE = 0;
            var basE = "nul";
            var basIE = 0;
            var gaucheE = "nul";
            var gaucheIE = 0;
            var droiteE = "nul";
            var droiteIE = 0;
            var puissanceEnnemi = 1;
            var coeffVitHelicoE = 1;
// gestion deplacement balle
            var directionY = 1;
            var directionX = 1;
// gestion collision
            var cooldown = 0;
            var toucheP = 0;
            var toucheE = 0;
            var toucheESuper = 0;
            var toucheCollision = 0;
// gestion post-process
            var pass1 = new THREE.ShaderPass(THREE.HorizontalTiltShiftShader);
            var renderer;
// Voir les fps
            /*var stats = new Stats();
            stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom
            document.body.appendChild(stats.dom);*/
            var lastLoop = new Date;
            var fps = 0;
            function initScene() {
                renderer = new THREE.WebGLRenderer({alpha: true, antialias: true, preserveDrawingBuffer: true}); // alpha: true pour fond blanc
                renderer.setSize(window.innerWidth, window.innerHeight, true);
                document.body.appendChild(renderer.domElement);
// Composer
                composer = new THREE.EffectComposer(renderer);
// Passes
                var renderPass = new THREE.RenderPass(scene, camera);
                composer.addPass(renderPass);
                pass1.renderToScreen = true;
                pass1.uniforms['tDiffuse'].value = 1;
                composer.addPass(pass1);
            }
// Initialisation des lumières
            function initLight() {
                var light = new THREE.PointLight(0xFFFFFF);
                light.position.set(10, 0, 30);
                scene.add(light);
            }
            function initGeometry() {
// Creation de la balle
                Balle = new THREE.Object3D();
                sphereGeometry2 = new THREE.SphereGeometry(0.2, 50, 50, 0, Math.PI * 2, 0, Math.PI * 2);
                material = new THREE.MeshBasicMaterial({color: 0x000000});
                Ball = new THREE.Mesh(sphereGeometry2, material);
                Ball.position.set(-11.5, 0, 1);
                //Pour les tests
                //Ball.position.set(2, -12, 1);
                Ball.material.transparent = true;
                Ball.material.opacity = 0.7;
                Balle.add(Ball);
// Creation des particules du cercle du joueur
                var particleCount = 31;
                var particles = new THREE.Geometry();
                var particle_Material = new THREE.PointsMaterial({
                color: 0x0FFFFFF,
                size: 0.1
                });
                var min = -10,
                max = 10;
                // Create the individual particles
                for (var i = 0; i < particleCount; i++) {
                var radius = 0.7;
                var random = Math.random();
                var variance = Math.random();
                var max = 10,
                    min = -10;
                //radius += (Math.floor(variance * (max - min + 1)) + min);
                var pX = radius * Math.sin(random * (2 * Math.PI)),
                    pY = radius * Math.cos(random * (2 * Math.PI)),
                    pZ = 1;
                var particle = new THREE.Vector3(
                                    pX,pY,pZ
                                );
                particle.velocity = new THREE.Vector3(
                                        0,
                                        -Math.random(),
                                        0
                                    );
                // Add the particle to the geometry
                particles.vertices.push(particle);
                }
                // Create the particle system
                particleSystemP = new THREE.Points(
                                        particles,particle_Material
                                    );
                particleSystemP.sortParticles = true;
                particleSystemP.name = "PartyCules";
                // Add the particle system to the scene
                scene.add(particleSystemP);
                var radius   = 0.7,
                segments = 64,
                material = new THREE.LineBasicMaterial( { color: 0x0000ff } ),
                geometry = new THREE.CircleGeometry( radius, segments );
                // Remove center vertex
                geometry.vertices.shift();
                circleP = new THREE.Line( geometry, material );
                circleP.position.z = 1;
                circleP.name = "Player";
                scene.add(circleP);
// JOKER : Creation des particules du cercle du joueur
                var particleCountJoker = 50;
                var particlesJoker = new THREE.Geometry();
                var particle_MaterialJoker = new THREE.PointsMaterial({
                color: 0x0FFFFFF,
                size: 0.1
                });
                var minJoker = -10,
                maxJoker = 10;
                // Create the individual particles
                for (var i = 0; i < particleCountJoker; i++) {
                var radiusJoker = (0.9 + Math.random()/10);
                var randomJoker = Math.random();
                var varianceJoker = Math.random();
                var maxJoker = 10,
                    minJoker = -10;
                //radius += (Math.floor(variance * (max - min + 1)) + min);
                var pXJoker = radiusJoker * Math.sin(randomJoker * (2 * Math.PI)),
                    pYJoker = radiusJoker * Math.cos(randomJoker * (2 * Math.PI)),
                    pZJoker = 1;
                var particleJoker = new THREE.Vector3(
                                    pX,pY,pZ
                                );
                particleJoker.velocity = new THREE.Vector3(
                                        0,
                                        -Math.random(),
                                        0
                                    );
                // Add the particle to the geometry
                particlesJoker.vertices.push(particleJoker);
                }
                // Create the particle system
                particleSystemPJoker = new THREE.Points(
                                        particles,particle_Material
                                    );
                particleSystemPJoker.sortParticles = true;
                particleSystemPJoker.name = "PartyCulesJoker";
                var radiusJoker   = 0.9,
                segmentsJoker = 64,
                materialJoker = new THREE.LineBasicMaterial( { color: 0x0000dd } ),
                geometryJoker = new THREE.CircleGeometry( radiusJoker, segmentsJoker );
                // Remove center vertex
                geometryJoker.vertices.shift();
                circlePJoker = new THREE.Line( geometryJoker, materialJoker );
                circlePJoker.position.z = 1;
                circlePJoker.name = "Player";
// Creation des particules du cercle ennemi
                var particleCount = 66;
                var particles = new THREE.Geometry();
                var particle_Material = new THREE.PointsMaterial({
                color: 0x000000,
                size: 0.2
                });
                var min = -10,
                max = 10;
                // Create the individual particles
                for (var i = 0; i < particleCount; i++) {
                var radius = 1;
                var random = Math.random();
                var variance = Math.random();
                var max = 10,
                    min = -10;
                //radius += (Math.floor(variance * (max - min + 1)) + min);
                var pX = radius * Math.sin(random * (2 * Math.PI)),
                    pY = radius * Math.cos(random * (2 * Math.PI)),
                    pZ = 1;
                var particle = new THREE.Vector3(
                                    pX,pY,pZ
                                );
                particle.velocity = new THREE.Vector3(
                                        0,
                                        -Math.random(),
                                        0
                                    );
                // Add the particle to the geometry
                particles.vertices.push(particle);
                }
                // Create the particle system
                particleSystemE = new THREE.Points(
                                        particles,particle_Material
                                    );
                particleSystemE.sortParticles = true;
                particleSystemE.name = "PartyCules";
                // Add the particle system to the scene
                scene.add(particleSystemE);
                var radius   = 1,
                segments = 64,
                material = new THREE.LineBasicMaterial( { color: 0xff0000 } ),
                geometry = new THREE.CircleGeometry( radius, segments );
                // Remove center vertex
                geometry.vertices.shift();
                circleE = new THREE.Line( geometry, material );
                circleE.position.z = 1;
                circleE.name = "Enemy";
                scene.add( circleE );
// Creation de la boussole sous le joueur
                aiguille = new THREE.Mesh(new THREE.BoxGeometry(0.2, 0.7, 0.1), new THREE.MeshBasicMaterial({color: 0xff0000}));
                aiguille.position.set(helico.position.x, helico.position.y, 1);
                aiguille.rotation.z = 0;
                scene.add(aiguille);
//Creation effets sur la balle
                var sphereGeometry = new THREE.SphereGeometry(0.2, 50, 50);
                var outlineMaterial1 = new THREE.MeshBasicMaterial( { color: 0xff0000, side: THREE.BackSide } );
                outlineMesh1 = new THREE.Mesh( sphereGeometry, outlineMaterial1 );
                outlineMesh1.position = Ball.position;
                outlineMesh1.scale.multiplyScalar(1.1);
                outlineMesh1.material.transparent = true;
                Balle.add( outlineMesh1 );
                var outlineMaterial2 = new THREE.MeshBasicMaterial( { color: 0xff5a00, side: THREE.BackSide } );
                outlineMesh2 = new THREE.Mesh( sphereGeometry, outlineMaterial2 );
                outlineMesh2.position = Ball.position;
                outlineMesh2.scale.multiplyScalar(1.2);
                outlineMesh2.material.transparent = true;
                Balle.add( outlineMesh2 );
                var outlineMaterial3 = new THREE.MeshBasicMaterial( { color: 0xff9a00, side: THREE.BackSide } );
                outlineMesh3 = new THREE.Mesh( sphereGeometry, outlineMaterial3 );
                outlineMesh3.position = Ball.position;
                outlineMesh3.scale.multiplyScalar(1.3);
                outlineMesh3.material.transparent = true;
                Balle.add( outlineMesh3 );
                var outlineMaterial4 = new THREE.MeshBasicMaterial( { color: 0xffce00, side: THREE.BackSide } );
                outlineMesh4 = new THREE.Mesh( sphereGeometry, outlineMaterial4 );
                outlineMesh4.position = Ball.position;
                outlineMesh4.scale.multiplyScalar(1.4);
                outlineMesh4.material.transparent = true;
                Balle.add( outlineMesh4 );
                var outlineMaterial5 = new THREE.MeshBasicMaterial( { color: 0xffe808, side: THREE.BackSide } );
                outlineMesh5 = new THREE.Mesh( sphereGeometry, outlineMaterial5 );
                outlineMesh5.position = Ball.position;
                outlineMesh5.scale.multiplyScalar(1.5);
                outlineMesh5.material.transparent = true;
                Balle.add( outlineMesh5 );
                scene.add(Balle);
                Ball.material.opacity = 0;
                outlineMesh1.material.opacity = 0;
                outlineMesh2.material.opacity = 0;
                outlineMesh3.material.opacity = 0;
                outlineMesh4.material.opacity = 0;
                outlineMesh5.material.opacity = 0;
// Ajout des nuages
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                var cloud = new THREE.Mesh(new THREE.PlaneGeometry(1171,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.position.y = 1100;
                cloud.position.z = 200;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG2.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                cloud = new THREE.Mesh(new THREE.PlaneGeometry(1171,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.rotation.y = -Math.PI / 2;
                cloud.position.x = 1000;
                cloud.position.y = -100;
                cloud.position.z = 250;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG3.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                var cloud = new THREE.Mesh(new THREE.PlaneGeometry(916,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.rotation.y = -Math.PI / 4;
                cloud.position.x = 900;
                cloud.position.y = 900;
                cloud.position.z = 200;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG4.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                var cloud = new THREE.Mesh(new THREE.PlaneGeometry(916,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.rotation.y = -Math.PI;
                cloud.position.x = -500;
                cloud.position.y = -900;
                cloud.position.z = 150;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG5.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                var cloud = new THREE.Mesh(new THREE.PlaneGeometry(916,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.rotation.y = Math.PI / 2;
                cloud.position.x = -900;
                cloud.position.z = 200;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
                texture = THREE.ImageUtils.loadTexture('src/medias/images/cloud_PNG6.png'),
                material = new THREE.MeshBasicMaterial({map: texture});
                var cloud = new THREE.Mesh(new THREE.PlaneGeometry(916,500), material);
                cloud.rotation.x = Math.PI / 2;
                cloud.rotation.y = Math.PI / 4;
                cloud.position.x = -800;
                cloud.position.y = 800;
                cloud.position.z = 150;
                cloud.material.transparent = true;
                cloud.material.opacity = 1;
                scene.add(cloud);
// Ajout quadrillage
                quadri = new THREE.Object3D();
                material = new THREE.LineBasicMaterial({color: 0x000000});
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 6,  0.01));
                line.vertices.push(new THREE.Vector3(-8, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-6, 6,  0.01));
                line.vertices.push(new THREE.Vector3(-6, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-4, 6,  0.01));
                line.vertices.push(new THREE.Vector3(-4, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-2, 6,  0.01));
                line.vertices.push(new THREE.Vector3(-2, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(0, 6,  0.01));
                line.vertices.push(new THREE.Vector3(0, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(2, 6,  0.01));
                line.vertices.push(new THREE.Vector3(2, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(4, 6,  0.01));
                line.vertices.push(new THREE.Vector3(4, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(6, 6,  0.01));
                line.vertices.push(new THREE.Vector3(6, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(8, 6,  0.01));
                line.vertices.push(new THREE.Vector3(8, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 6,  0.01));
                line.vertices.push(new THREE.Vector3(8, 6, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 8,  0.01));
                line.vertices.push(new THREE.Vector3(8, 8, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 10,  0.01));
                line.vertices.push(new THREE.Vector3(8, 10, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 12,  0.01));
                line.vertices.push(new THREE.Vector3(8, 12, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 14,  0.01));
                line.vertices.push(new THREE.Vector3(8, 14, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 16,  0.01));
                line.vertices.push(new THREE.Vector3(8, 16, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 18,  0.01));
                line.vertices.push(new THREE.Vector3(8, 18, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 20,  0.01));
                line.vertices.push(new THREE.Vector3(8, 20, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, 22,  0.01));
                line.vertices.push(new THREE.Vector3(8, 22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -6,  0.01));
                line.vertices.push(new THREE.Vector3(-8, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-6, -6,  0.01));
                line.vertices.push(new THREE.Vector3(-6, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-4, -6,  0.01));
                line.vertices.push(new THREE.Vector3(-4, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-2, -6,  0.01));
                line.vertices.push(new THREE.Vector3(-2, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(0, -6,  0.01));
                line.vertices.push(new THREE.Vector3(0, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(2, -6,  0.01));
                line.vertices.push(new THREE.Vector3(2, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(4, -6,  0.01));
                line.vertices.push(new THREE.Vector3(4, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(6, -6,  0.01));
                line.vertices.push(new THREE.Vector3(6, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(8, -6,  0.01));
                line.vertices.push(new THREE.Vector3(8, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -6,  0.01));
                line.vertices.push(new THREE.Vector3(8, -6, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -8,  0.01));
                line.vertices.push(new THREE.Vector3(8, -8, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -10,  0.01));
                line.vertices.push(new THREE.Vector3(8, -10, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -12,  0.01));
                line.vertices.push(new THREE.Vector3(8, -12, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -14,  0.01));
                line.vertices.push(new THREE.Vector3(8, -14, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -16,  0.01));
                line.vertices.push(new THREE.Vector3(8, -16, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -18,  0.01));
                line.vertices.push(new THREE.Vector3(8, -18, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -20,  0.01));
                line.vertices.push(new THREE.Vector3(8, -20, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                line = new THREE.Geometry();
                line.vertices.push(new THREE.Vector3(-8, -22,  0.01));
                line.vertices.push(new THREE.Vector3(8, -22, 0.01));
                Line = new THREE.Line(line, material);
                quadri.add(Line);
                quadri.position.z = -0.1;
                quadri.visible = true;
                scene.add(quadri);
// Ajout des bases joueur/ennemi
                loader.load('src/medias/models/baseE.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    baseE = new THREE.Mesh( geometry, material );
                    baseE.name = "BaseE";
                    baseE.scale.set(1.1,1.1,1.1);
                    baseE.rotation.x = Math.PI / 2;
                    baseE.position.set(-2, 25, -0.5);
                    options.add(baseE);
                    //scene.add(options);
                });
                var outlineMaterial6 = new THREE.MeshBasicMaterial( { color: 0xaa0000 } );
                cube = new THREE.BoxGeometry(16.1, 0.5, 0.01);
                var barre = new THREE.Mesh( cube, outlineMaterial6 );
                barre.position.set(0, 23, 0.09);
                barre.name = "Ligne Base Ennemie";
                barresBut.add(barre);
                scene.add(barresBut);
                loader.load('src/medias/models/baseP.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    baseP = new THREE.Mesh( geometry, material );
                    baseP.name = "BaseP";
                    baseP.scale.set(0.8,0.8,0.8);
                    baseP.rotation.x = Math.PI / 2;
                    baseP.rotation.y = -Math.PI / 2;
                    baseP.position.set(5, -30, 1.2);
                    options.add(baseP);
                    //scene.add(options);
                });
                var outlineMaterial6 = new THREE.MeshBasicMaterial( { color: 0x0000aa } );
                cube = new THREE.BoxGeometry(16.1, 0.5, 0.01);
                var barre = new THREE.Mesh( cube, outlineMaterial6 );
                barre.position.set(0, -23, 0.09);
                barre.name = "Ligne Base Joueur";
                barresBut.add(barre);
                scene.add(barresBut);
// Ajout du bateau pirate
                loader.load('src/medias/models/perla.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    pirate = new THREE.Mesh( geometry, material );
                    pirate.name = "Bateau Pirate";
                    pirate.scale.set(1.1,1.1,1.1);
                    pirate.rotation.x = Math.PI / 2 - 0.1;
                    pirate.position.set(-13, 0, 0.3);
                    options.add(pirate);
                    //scene.add(options);
                });
                pirateSprite.scale.set(12, 7.63, 10);
                pirateSprite.position.set(-15,-1,3);
                scene.add(pirateSprite);
// Ajout des helicos (joueur/ennemi)
                helico1 = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), material); // Initialiser helico
                helico2 = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), material); // Initialiser helico
                helicoE1 = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), material);
                helicoE2 = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), material);
                loader.load('src/medias/models/helico.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    helico1 = new THREE.Mesh( geometry, material );
                    helico1.name = "helico";
                    helico1.scale.set(0.2,0.2,0.2);
                    //helico.rotation.x = Math.PI / 2 - 0.1;
                    helico1.position.set(0,0,1.5);
                    helico.add(helico1);
                });
                loader.load('src/medias/models/helico2.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    helico2 = new THREE.Mesh( geometry, material );
                    helico2.name = "helico";
                    helico2.scale.set(0.2,0.2,0.2);
                    //helico.rotation.z = Math.PI/2;
                    helico2.position.set(0,0,1.5);
                    helico.add(helico2);
                });
                scene.add(helico); // helico du joueur
                loader.load('src/medias/models/helicoE_.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    helicoE1 = new THREE.Mesh( geometry, material );
                    helicoE1.name = "helico ennemi";
                    helicoE1.scale.set(0.4,0.4,0.4);
                    //helicoE1.rotation.z = Math.PI;
                    helicoE1.position.set(0,0,2);
                    helicoE.add(helicoE1);
                });
                loader.load('src/medias/models/helicoE2.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    helicoE2 = new THREE.Mesh( geometry, material );
                    helicoE2.name = "helico ennemi";
                    helicoE2.scale.set(0.4,0.4,0.4);
                    //helicoE2.rotation.z = Math.PI;
                    helicoE2.position.set(0,0,2);
                    helicoE.add(helicoE2);
                });
                helicoE.position.set(-6,8,0);
                scene.add(ennemiSprite);
// Divers ajout pour l'environnement
                loader.load('src/medias/models/seagull.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    Seagull = new THREE.SkinnedMesh( geometry, material );
                    Seagull.name = "Mouette";
                    Seagull.rotation.x = Math.PI/2;
                    Seagull.rotation.y = 0;
                    Seagull.position.set(0,0,5);
                    scene.add(Seagull);
                });
                loader.load('src/medias/models/shark.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    Shark = new THREE.Mesh( geometry, material );
                    Shark.name = "Requin";
                    Shark.rotation.x = Math.PI/2;
                    Shark.rotation.y = Math.PI/2;
                    Shark.position.set(-40,0,-1);
                    if (Math.random() < 0.5) {
                        Shark.position.y = 5;
                    }
                    else {Shark.position.y = -5}
                    options.add(Shark);
                });
// Ajout des power-up
                loader.load('src/medias/models/tree.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    material.side = THREE.DoubleSide;
                    tree = new THREE.Mesh( geometry, material );
                    tree.name = "Arbre";
                    tree.scale.set(0.2,0.2,0.2);
                    tree.rotation.x = Math.PI / 2;
                    tree.rotation.y = Math.PI / 2;
                    tree.position.set(1000, -1, -0.15);
                    bonus1.add(tree);
                    scene.add(bonus1);
                });
                loader.load('src/medias/models/submarine.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    material.side = THREE.DoubleSide;
                    submarine = new THREE.Mesh( geometry, material );
                    submarine.name = "SousMarin";
                    submarine.scale.set(1,1,1);
                    submarine.rotation.x = Math.PI / 2;
                    submarine.rotation.y = -Math.PI / 2;
                    submarine.position.set(-1000, 2, -1.2);
                    bonus1.add(submarine);
                    scene.add(bonus1);
                });
                loader.load('src/medias/models/submarine.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    material.side = THREE.DoubleSide;
                    submarineJoker = new THREE.Mesh( geometry, material );
                    submarineJoker.name = "SousMarinJoker";
                    submarineJoker.scale.set(1,1,1);
                    submarineJoker.rotation.x = Math.PI / 2;
                    submarineJoker.rotation.y = -Math.PI / 2;
                    submarineJoker.position.set(0, -10, -20);
                });
// Ajout des bouees
                var barre = new THREE.Mesh(new THREE.BoxGeometry(0.5, 46.2, 0.01), new THREE.MeshBasicMaterial({ color: 0x000000 }));
                barre.position.set(9, 0, 0.09);
                boueesAlt.add(barre);
                var barre = new THREE.Mesh(new THREE.BoxGeometry(0.5, 46.2, 0.01), new THREE.MeshBasicMaterial({ color: 0x000000 }));
                barre.position.set(-9, 0, 0.09);
                boueesAlt.add(barre);
                scene.add(boueesAlt);
                // 4 différents types de bouees pour une gestion de houle plus realiste
                bouees1 = new THREE.Object3D();
                bouees2 = new THREE.Object3D();
                bouees3 = new THREE.Object3D();
                bouees4 = new THREE.Object3D();
        // Pas de boucle parce que l'incrémentation du variables temporaire prendrait effet de suite alors que le chargement des modèles arrivent en fin -> Tout les modèles se chargent quand la variable à atteint sa valeur finale et se retrouvent ainsi au meme emplacement
            // PARTIE GAUCHE
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-22,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-20,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-18,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-16,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-14,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-12,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-10,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-8,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-6,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-4,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,-2,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,0,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,2,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,4,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,6,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,8,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,10,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,12,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,14,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,16,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,18,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,20,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(-9,22,0);
                    bouees2.add(bouee);
                });
            // PARTIE DROITE
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,22,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,20,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,18,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,16,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,14,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,12,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,10,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,8,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,6,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,4,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,2,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,0,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-2,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-4,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-6,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-8,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-10,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-12,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-14,0);
                    bouees2.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-16,0);
                    bouees4.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-18,0);
                    bouees1.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-20,0);
                    bouees3.add(bouee);
                });
                loader.load('src/medias/models/Bouee.json', function addModelToScene( geometry, materials) {
                    var material = new THREE.MeshFaceMaterial(materials);
                    bouee = new THREE.Mesh( geometry, material );
                    bouee.name = "Bouee1";
                    bouee.scale.set(0.2,0.2,0.2);
                    bouee.rotation.x = Math.PI/2;
                    bouee.rotation.y = Math.PI/2;
                    bouee.position.set(9,-22,0);
                    bouees2.add(bouee);
                });
          </script>
          
          
          // Creation de l'effet d'eau
                var waterNormals = new THREE.ImageUtils.loadTexture('src/medias/images/waternormals.jpg');
                waterNormals.wrapS = waterNormals.wrapT = THREE.RepeatWrapping; 
        
                var light = new THREE.PointLight(0xFFFFFF);
                light.position.set(30, 30, 30);
                ms_Water = new THREE.Water(renderer, camera, scene, {
                    textureWidth: 256,
                    textureHeight: 256,
                    waterNormals: waterNormals,
                    alpha:  0.95,
                    sunDirection: light.position.normalize(),
                    //sunColor: 0xfdb813,
                    sunColor: 0xfcd440,
                    waterColor: 0x006994,
                    betaVersion: 0,
                    side: THREE.DoubleSide
                });
                var aMeshMirror = new THREE.Mesh(
                    new THREE.PlaneBufferGeometry(2000, 2000, 10, 10), 
                    ms_Water.material
                );
                aMeshMirror.add(ms_Water);
                
               scene.add(aMeshMirror);
// Creation de la skybox
               var aCubeMap = THREE.ImageUtils.loadTextureCube([
                  'src/medias/images/nx.jpg',
                  'src/medias/images/px.jpg',
                  'src/medias/images/pz.jpg',
                  'src/medias/images/nz.jpg',
                  'src/medias/images/py.jpg',
                  'src/medias/images/ny.jpg'
                ]);
                aCubeMap.format = THREE.RGBFormat;
                var aShader = THREE.ShaderLib['cube'];
                aShader.uniforms['tCube'].value = aCubeMap;
                var aSkyBoxMaterial = new THREE.ShaderMaterial({
                  fragmentShader: aShader.fragmentShader,
                  vertexShader: aShader.vertexShader,
                  uniforms: aShader.uniforms,
                  depthWrite: false,
                  side: THREE.BackSide
                });
                var aSkybox = new THREE.Mesh(
                  new THREE.BoxGeometry(3000, 3000, 3000),
                  aSkyBoxMaterial
                );
                //aSkybox.rotation.z = -Math.PI * 0.5;
                aSkybox.position.z = 100;
                
                scene.add(aSkybox);
// Differents tests pour le placement des bateaux
                addBateau(2, "G", 1, "droite");
                addBateau(4, "H", 8, "gauche");
                addBateauE(2, "A", 3, "gauche");
                addBateauE(4, "H", 8, "haut");
            }; // fin initGeometry
// Gestion Des Collisions//
            // Rays
            this.rays = [
                new THREE.Vector3(0, 0, 1),
                new THREE.Vector3(1, 0, 1),
                new THREE.Vector3(1, 0, 0),
                new THREE.Vector3(1, 0, -1),
                new THREE.Vector3(0, 0, -1),
                new THREE.Vector3(-1, 0, -1),
                new THREE.Vector3(-1, 0, 0),
                new THREE.Vector3(-1, 0, 1)
            ];
            this.ray = new THREE.Raycaster();
            function checkCollisionsPaddle(b, vec, objects) {
                this.ray.set(b.position.clone(), vec);
                var collResults = this.ray.intersectObjects(objects, true);
                if (collResults.length > 0 && collResults[0].distance < 1) {
                    var object = collResults[0].object;
                    console.log("Collision avec " + object.name);
                    if (object.name == "Player"){
                        if (toucheP == 0) {
                            setTimeout(function(){
                                directionY = directionY * -1;
                            }, 20);
                            cooldown = 1;
                            toucheP = 1;
                            coeffVitBall += 0.01;
                            var sound = new Howl({
                              urls: ['src/medias/sounds/drum.wav']
                            }).play();
                            setTimeout(function(){
                                toucheP = 0;
                            }, 500);
                        }
                    }
                    if (object.name == "Enemy"){
                        if (toucheE == 0) {
                            setTimeout(function(){
                                directionY = directionY * -1;
                            }, 20);
                            cooldown = 1;
                            toucheE = 1;
                            toucheESuper = 1;
                            coeffVitBall += 0.01;
                            var sound = new Howl({
                              urls: ['src/medias/sounds/drum.wav']
                            }).play();
                            setTimeout(function(){
                                toucheE = 0;
                            }, 500);
                            setTimeout(function(){
                                toucheESuper = 0;
                            }, 2000);
                        }
                    }
                    launch=1;
                    
                    return object;
                }
            };
            function checkCollisionsContour(b, vec, objects) {
                this.ray.set(b.position.clone(), vec);
                var collResults = this.ray.intersectObjects(objects, true);
                if (collResults.length > 0 && collResults[0].distance < 1) {
                    var object = collResults[0].object;
                    console.log("Collision avec " + object.name);
                    if ((object.name == "Petit Bateau L Y T") || (object.name == "Petit Bateau L Y B") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau2.position.z = bateau2.position.z - 0.2;
                        bateau2.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau2.rotation.y += -0.05;
                        bateau2.rotation.z -= Math.PI/20;
                        pvBoat2 -= 1;
                        if (pvBoat2 <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Petit Bateau"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G Y B"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionY = directionY * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 400);
                    };
                    if ((object.name == "Petit Bateau L X L") || (object.name == "Petit Bateau L X R") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau2.position.z = bateau2.position.z - 0.1;
                        bateau2.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau2.rotation.y += -0.05;
                        bateau2.rotation.z -= Math.PI/20;
                        pvBoat2 -= 1;
                        if (pvBoat2 <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Petit Bateau"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau G Y B"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionX = directionX * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 200);
                    };
                    if ((object.name == "Petit Bateau E L Y T") || (object.name == "Petit Bateau E L Y B") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau2E.position.z = bateau2.position.z - 0.2;
                        bateau2E.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau2E.rotation.y += -0.05;
                        bateau2E.rotation.z -= Math.PI/20;
                        pvBoat2E -= 1;
                        if (pvBoat2E <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Petit Bateau E"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G Y B"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionY = directionY * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 400);
                    };
                    if ((object.name == "Petit Bateau E L X L") || (object.name == "Petit Bateau E L X R") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau2E.position.z = bateau2.position.z - 0.1;
                        bateau2E.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau2E.rotation.y += -0.05;
                        bateau2E.rotation.z -= Math.PI/20;
                        pvBoat2E -= 1;
                        if (pvBoat2E <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Petit Bateau E"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L X L"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L X R"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E G Y B"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L Y T"))
                            selectedObject.add(scene.getObjectByName("Petit Bateau E L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionX = directionX * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 200);
                    };
                    if ((object.name == "Grand Bateau L Y T") || (object.name == "Grand Bateau L Y B") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau4.position.z = bateau4.position.z - 0.2;
                        bateau4.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau4.rotation.y += -0.05;
                        bateau4.rotation.z -= Math.PI/20;
                        pvBoat4 -= 1;
                        if (pvBoat4 <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Grand Bateau"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G Y B"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionY = directionY * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 400);
                    };
                    if ((object.name == "Grand Bateau L X L") || (object.name == "Grand Bateau L X R") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau4.position.z = bateau4.position.z - 0.1;
                        bateau4.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau4.rotation.y += -0.05;
                        bateau4.rotation.z -= Math.PI/20;
                        pvBoat4 -= 1;
                        if (pvBoat4 <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Grand Bateau"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau G Y B"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionX = directionX * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 200);
                    };
                    if ((object.name == "Grand Bateau E L Y T") || (object.name == "Grand Bateau E L Y B") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau4E.position.z = bateau4E.position.z - 0.2;
                        bateau4E.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau4E.rotation.y += -0.05;
                        bateau4E.rotation.z -= Math.PI/20;
                        pvBoat4E -= 1;
                        if (pvBoat4E <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Grand Bateau E"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G Y B"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionY = directionY * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 400);
                    };
                    if ((object.name == "Grand Bateau E L X L") || (object.name == "Grand Bateau E L X R") && toucheCollision == 0) {
                        toucheCollision = 1;
                        bateau4E.position.z = bateau4E.position.z - 0.1;
                        bateau4E.rotation.x += Math.sin(Math.random())/ 1000;
                        bateau4E.rotation.y += -0.05;
                        bateau4E.rotation.z -= Math.PI/20;
                        pvBoat4E -= 1;
                        if (pvBoat4E <= 0) {
                            var selectedObject = new THREE.Object3D();
                            selectedObject.add(scene.getObjectByName("Grand Bateau E"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L X L"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L X R"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E G Y B"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L Y T"))
                            selectedObject.add(scene.getObjectByName("Grand Bateau E L Y B"))
                            scene.remove( selectedObject );
                        };
                        directionX = directionX * -1;
                        setTimeout(function(){
                            toucheCollision = 0;
                        }, 200);
                    };
                    launch=1;
                    console.log(pvBoat2);
                    
                    return object;
                }
            };
            function checkCollisionsBonus(b, vec, objects) {
                this.ray.set(b.position.clone(), vec);
                var collResults = this.ray.intersectObjects(objects, true);
                if (collResults.length > 0 && collResults[0].distance < 1) {
                    var object = collResults[0].object;
                    console.log("Collision avec " + object.name);
                    if (object.name == "Arbre"){
                        scene.remove(particleSystemP);
                        scene.add(particleSystemPJoker);
                        scene.remove(circleP);
                        scene.add(circlePJoker);
                        arbreBonusTerrain = false;
                        arbreBonus = true;
                        setTimeout(function(){
                            scene.add(particleSystemP);
                            scene.remove(particleSystemPJoker);
                            scene.add(circleP);
                            scene.remove(circlePJoker);
                            arbreBonus = false;
                            arbreBonusTerrain = true;
                        }, 15000)
                    }
                    if (object.name == "SousMarinJoker"){
                        scene.remove(submarineJoker);
                        submarineJoker.position.z -= 15;
                        directionY = directionY * -1;
                        ssMarinBonus = false;
                        setTimeout(function(){
                            ssMarinBonusTerrain = true;
                        }, 15000)
                    }
                    
                    return object;
                }
            };
// Calcul de distance
            function Distance(object1, object2) {
                    return Math.sqrt((object1.position.y - object2.position.y) * (object1.position.y - object2.position.y) + (object1.position.x - object2.position.x) * (object1.position.x - object2.position.x));
            }
// Music
            function music() {
                var music = new Howl({
                urls: ['src/medias/music/music3.mp3'],
                autoplay: true,
                loop: false,
                volume: 0.3,
                buffer: true,
                onend: function() {
                    next();
                }
                });
            }
            function next() {
                var music = new Howl({
                urls: ['src/medias/music/music5.mp3'],
                autoplay: true,
                loop: false,
                volume: 0.3,
                buffer: true
                });
            }
  </body>
</html>
